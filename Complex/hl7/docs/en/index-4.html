<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>The HL7_lib Handbook: Specification</TITLE>
 <LINK HREF="index-5.html" REL=next>
 <LINK HREF="index-3.html" REL=previous>
 <LINK HREF="index.html#toc4" REL=contents>
</HEAD>
<BODY>
<A HREF="index-5.html">Next</A>
<A HREF="index-3.html">Previous</A>
<A HREF="index.html#toc4">Contents</A>
<HR>
<H2><A NAME="s4">4. Specifications</A></H2>

<P>Essentially I am going to develop a very low leverl HL7 library to work directly with the
HL7 messages.  This means that I want to break the message into a data representation that
is most suitable for each language involved.
<P>
<P><H3>General Specification</H3>
<P>
<P><H4>There will be the following needed functions:</H4>
<P>
<P>Convert a string into the data representation.
<P>Convert the data representation into a string.
<P>Read the elements of the data representation.
<P>Set the elements of the data representation to a given value.
<P>Delete portions of the data representation.
<P>Insert new sections into the data representation.
<P>
<P>Some higher level functions will wrap around these lower level functions to allow us
 to work with the elements by segment name.
<P>
<P><H3>More detailed specification</H3>
<P>These aren't as specific as they could be because I am developing this spec for
more than one language.
<P>
<P><B>message = str2hl7(string)</B>
<P>Convert a string into a message.
<P>Input:
<P>Process:
<P>Output:
<P>Hidden functions:
<P>message=split(message)
<P>
<P><B>string = hl72str(message)</B>
<P>Convert a message into a string.
<P>Is this the same as hl7get at the message level?
<P>Input:
<P>Process:
<P>Output:
<P><B>void hl7free(message)</B>
<P>Destroy a message.
<P>Input:
<P>Process:
<P>Output:
<P><B>void hl7print(stream, message)</B>
<P>Print a representation of the message to the given stream.
<P>Input:
<P>Process:
<P>Output:
<P><B>string = hl7rawget(message, location)</B>
<P>Read a portion of the message.
<P>When getting an element at the subcomponent level we must also translate the escaped characters into their real values.
<P>Input:
<P>Process:
<P>Output:
<P><B>void hl7rawset(message, location, string)</B>
<P>Set an existing portion of the message to a set value.
<P>Input:
<P>Process:
<P>Output:
<P><B>*string = hl7get(message, segment location)</B>
<P>This wraps around the hl7rawget and uses relative locations based on segment.
<P>In C we must be careful to destroy this returned string when we are done, or we will create a memory leak.  We allocate the memory and free it this way because we never want to use arbirary sized buffers that will someday get overwritten with a string longer than we thought.
<P>Input:
<P>Process:
<P>Output:
<P><B>string = hl7set(message, segment location)</B>
<P>This wraps around the hl7rawset and uses relative locations based on segment.
<P>Input:
<P>Process:
<P>Output:
<P><B>void hl7rawinsert(message, location, string)</B>
<P>Insert the string into the given absolute location in the message.
<P>Input:
<P>Process:
<P>Output:
<P><B>void hl7rawdelete(message, location)</B>
<P>Delete the portion of the message given by the absolute location from the message.
<P>Input:
<P>Process:
<P>Output:
<P><B>void hl7insert(message, segment location, string)</B>
<P>Insert the string into the given segment location in the message.
<P> Is this the same as hl7set???
<P>Input:
<P>Process:
<P>Output:
<P><B>void hl7delete(message, segment location)</B>
<P>Delete the portion of the message given by the segment location from the message.
<P>Input:
<P>Process:
<P>Output:
<P><B>int hl7count(message, location)</B>
<P>Counts the number of items at the level specified in the location.
<P>
<P>
<P>
<P>
<P>
<P>
<P>
<P>
<P>
<P>
<HR>
<A HREF="index-5.html">Next</A>
<A HREF="index-3.html">Previous</A>
<A HREF="index.html#toc4">Contents</A>
</BODY>
</HTML>
